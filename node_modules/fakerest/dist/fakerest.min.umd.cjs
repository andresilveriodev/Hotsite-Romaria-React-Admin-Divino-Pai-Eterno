(function(p,$){typeof exports=="object"&&typeof module<"u"?$(exports):typeof define=="function"&&define.amd?define(["exports"],$):(p=typeof globalThis<"u"?globalThis:p||self,$(p.FakeRest={}))})(this,function(p){"use strict";var Wd=Object.defineProperty;var Xd=(p,$,O)=>$ in p?Wd(p,$,{enumerable:!0,configurable:!0,writable:!0,value:O}):p[$]=O;var y=(p,$,O)=>(Xd(p,typeof $!="symbol"?$+"":$,O),O);var $=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function O(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var zt=Array.isArray,S=zt,Vt=typeof $=="object"&&$&&$.Object===Object&&$,Se=Vt,Jt=Se,Qt=typeof self=="object"&&self&&self.Object===Object&&self,Wt=Jt||Qt||Function("return this")(),T=Wt,Xt=T,Yt=Xt.Symbol,D=Yt,Ce=D,je=Object.prototype,Zt=je.hasOwnProperty,kt=je.toString,F=Ce?Ce.toStringTag:void 0;function er(t){var e=Zt.call(t,F),r=t[F];try{t[F]=void 0;var a=!0}catch{}var n=kt.call(t);return a&&(e?t[F]=r:delete t[F]),n}var tr=er,rr=Object.prototype,ar=rr.toString;function nr(t){return ar.call(t)}var sr=nr,Ee=D,ir=tr,or=sr,cr="[object Null]",lr="[object Undefined]",Ie=Ee?Ee.toStringTag:void 0;function ur(t){return t==null?t===void 0?lr:cr:Ie&&Ie in Object(t)?ir(t):or(t)}var B=ur;function fr(t){return t!=null&&typeof t=="object"}var C=fr,dr=B,hr=C,gr="[object Symbol]";function pr(t){return typeof t=="symbol"||hr(t)&&dr(t)==gr}var re=pr,yr=S,br=re,vr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$r=/^\w*$/;function _r(t,e){if(yr(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||br(t)?!0:$r.test(t)||!vr.test(t)||e!=null&&t in Object(e)}var mr=_r;function Ar(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var P=Ar,wr=B,Tr=P,Or="[object AsyncFunction]",Sr="[object Function]",Cr="[object GeneratorFunction]",jr="[object Proxy]";function Er(t){if(!Tr(t))return!1;var e=wr(t);return e==Sr||e==Cr||e==Or||e==jr}var Pe=Er,Ir=T,Pr=Ir["__core-js_shared__"],xr=Pr,ae=xr,xe=function(){var t=/[^.]+$/.exec(ae&&ae.keys&&ae.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Mr(t){return!!xe&&xe in t}var Nr=Mr,Rr=Function.prototype,Lr=Rr.toString;function Dr(t){if(t!=null){try{return Lr.call(t)}catch{}try{return t+""}catch{}}return""}var Me=Dr,Fr=Pe,Br=Nr,Ur=P,Gr=Me,Kr=/[\\^$.*+?()[\]{}|]/g,Hr=/^\[object .+?Constructor\]$/,qr=Function.prototype,zr=Object.prototype,Vr=qr.toString,Jr=zr.hasOwnProperty,Qr=RegExp("^"+Vr.call(Jr).replace(Kr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Wr(t){if(!Ur(t)||Br(t))return!1;var e=Fr(t)?Qr:Hr;return e.test(Gr(t))}var Xr=Wr;function Yr(t,e){return t==null?void 0:t[e]}var Zr=Yr,kr=Xr,ea=Zr;function ta(t,e){var r=ea(t,e);return kr(r)?r:void 0}var j=ta,ra=j,aa=ra(Object,"create"),U=aa,Ne=U;function na(){this.__data__=Ne?Ne(null):{},this.size=0}var sa=na;function ia(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var oa=ia,ca=U,la="__lodash_hash_undefined__",ua=Object.prototype,fa=ua.hasOwnProperty;function da(t){var e=this.__data__;if(ca){var r=e[t];return r===la?void 0:r}return fa.call(e,t)?e[t]:void 0}var ha=da,ga=U,pa=Object.prototype,ya=pa.hasOwnProperty;function ba(t){var e=this.__data__;return ga?e[t]!==void 0:ya.call(e,t)}var va=ba,$a=U,_a="__lodash_hash_undefined__";function ma(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=$a&&e===void 0?_a:e,this}var Aa=ma,wa=sa,Ta=oa,Oa=ha,Sa=va,Ca=Aa;function x(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var a=t[e];this.set(a[0],a[1])}}x.prototype.clear=wa,x.prototype.delete=Ta,x.prototype.get=Oa,x.prototype.has=Sa,x.prototype.set=Ca;var ja=x;function Ea(){this.__data__=[],this.size=0}var Ia=Ea;function Pa(t,e){return t===e||t!==t&&e!==e}var ne=Pa,xa=ne;function Ma(t,e){for(var r=t.length;r--;)if(xa(t[r][0],e))return r;return-1}var G=Ma,Na=G,Ra=Array.prototype,La=Ra.splice;function Da(t){var e=this.__data__,r=Na(e,t);if(r<0)return!1;var a=e.length-1;return r==a?e.pop():La.call(e,r,1),--this.size,!0}var Fa=Da,Ba=G;function Ua(t){var e=this.__data__,r=Ba(e,t);return r<0?void 0:e[r][1]}var Ga=Ua,Ka=G;function Ha(t){return Ka(this.__data__,t)>-1}var qa=Ha,za=G;function Va(t,e){var r=this.__data__,a=za(r,t);return a<0?(++this.size,r.push([t,e])):r[a][1]=e,this}var Ja=Va,Qa=Ia,Wa=Fa,Xa=Ga,Ya=qa,Za=Ja;function M(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var a=t[e];this.set(a[0],a[1])}}M.prototype.clear=Qa,M.prototype.delete=Wa,M.prototype.get=Xa,M.prototype.has=Ya,M.prototype.set=Za;var K=M,ka=j,en=T,tn=ka(en,"Map"),se=tn,Re=ja,rn=K,an=se;function nn(){this.size=0,this.__data__={hash:new Re,map:new(an||rn),string:new Re}}var sn=nn;function on(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var cn=on,ln=cn;function un(t,e){var r=t.__data__;return ln(e)?r[typeof e=="string"?"string":"hash"]:r.map}var H=un,fn=H;function dn(t){var e=fn(this,t).delete(t);return this.size-=e?1:0,e}var hn=dn,gn=H;function pn(t){return gn(this,t).get(t)}var yn=pn,bn=H;function vn(t){return bn(this,t).has(t)}var $n=vn,_n=H;function mn(t,e){var r=_n(this,t),a=r.size;return r.set(t,e),this.size+=r.size==a?0:1,this}var An=mn,wn=sn,Tn=hn,On=yn,Sn=$n,Cn=An;function N(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var a=t[e];this.set(a[0],a[1])}}N.prototype.clear=wn,N.prototype.delete=Tn,N.prototype.get=On,N.prototype.has=Sn,N.prototype.set=Cn;var ie=N,Le=ie,jn="Expected a function";function oe(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(jn);var r=function(){var a=arguments,n=e?e.apply(this,a):a[0],s=r.cache;if(s.has(n))return s.get(n);var i=t.apply(this,a);return r.cache=s.set(n,i)||s,i};return r.cache=new(oe.Cache||Le),r}oe.Cache=Le;var En=oe,In=En,Pn=500;function xn(t){var e=In(t,function(a){return r.size===Pn&&r.clear(),a}),r=e.cache;return e}var Mn=xn,Nn=Mn,Rn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ln=/\\(\\)?/g,Dn=Nn(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Rn,function(r,a,n,s){e.push(n?s.replace(Ln,"$1"):a||r)}),e}),Fn=Dn;function Bn(t,e){for(var r=-1,a=t==null?0:t.length,n=Array(a);++r<a;)n[r]=e(t[r],r,t);return n}var Un=Bn,De=D,Gn=Un,Kn=S,Hn=re,qn=1/0,Fe=De?De.prototype:void 0,Be=Fe?Fe.toString:void 0;function Ue(t){if(typeof t=="string")return t;if(Kn(t))return Gn(t,Ue)+"";if(Hn(t))return Be?Be.call(t):"";var e=t+"";return e=="0"&&1/t==-qn?"-0":e}var zn=Ue,Vn=zn;function Jn(t){return t==null?"":Vn(t)}var Qn=Jn,Wn=S,Xn=mr,Yn=Fn,Zn=Qn;function kn(t,e){return Wn(t)?t:Xn(t,e)?[t]:Yn(Zn(t))}var es=kn,ts=re,rs=1/0;function as(t){if(typeof t=="string"||ts(t))return t;var e=t+"";return e=="0"&&1/t==-rs?"-0":e}var ns=as,ss=es,is=ns;function os(t,e){e=ss(e,t);for(var r=0,a=e.length;t!=null&&r<a;)t=t[is(e[r++])];return r&&r==a?t:void 0}var cs=os,ls=cs;function us(t,e,r){var a=t==null?void 0:ls(t,e);return a===void 0?r:a}var fs=us;const b=O(fs);var ds=K;function hs(){this.__data__=new ds,this.size=0}var gs=hs;function ps(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var ys=ps;function bs(t){return this.__data__.get(t)}var vs=bs;function $s(t){return this.__data__.has(t)}var _s=$s,ms=K,As=se,ws=ie,Ts=200;function Os(t,e){var r=this.__data__;if(r instanceof ms){var a=r.__data__;if(!As||a.length<Ts-1)return a.push([t,e]),this.size=++r.size,this;r=this.__data__=new ws(a)}return r.set(t,e),this.size=r.size,this}var Ss=Os,Cs=K,js=gs,Es=ys,Is=vs,Ps=_s,xs=Ss;function R(t){var e=this.__data__=new Cs(t);this.size=e.size}R.prototype.clear=js,R.prototype.delete=Es,R.prototype.get=Is,R.prototype.has=Ps,R.prototype.set=xs;var ce=R;function Ms(t,e){for(var r=-1,a=t==null?0:t.length;++r<a&&e(t[r],r,t)!==!1;);return t}var Ns=Ms,Rs=j,Ls=function(){try{var t=Rs(Object,"defineProperty");return t({},"",{}),t}catch{}}(),Ds=Ls,Ge=Ds;function Fs(t,e,r){e=="__proto__"&&Ge?Ge(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var Ke=Fs,Bs=Ke,Us=ne,Gs=Object.prototype,Ks=Gs.hasOwnProperty;function Hs(t,e,r){var a=t[e];(!(Ks.call(t,e)&&Us(a,r))||r===void 0&&!(e in t))&&Bs(t,e,r)}var He=Hs,qs=He,zs=Ke;function Vs(t,e,r,a){var n=!r;r||(r={});for(var s=-1,i=e.length;++s<i;){var o=e[s],c=a?a(r[o],t[o],o,r,t):void 0;c===void 0&&(c=t[o]),n?zs(r,o,c):qs(r,o,c)}return r}var q=Vs;function Js(t,e){for(var r=-1,a=Array(t);++r<t;)a[r]=e(r);return a}var Qs=Js,Ws=B,Xs=C,Ys="[object Arguments]";function Zs(t){return Xs(t)&&Ws(t)==Ys}var ks=Zs,qe=ks,ei=C,ze=Object.prototype,ti=ze.hasOwnProperty,ri=ze.propertyIsEnumerable,ai=qe(function(){return arguments}())?qe:function(t){return ei(t)&&ti.call(t,"callee")&&!ri.call(t,"callee")},ni=ai,z={exports:{}};function si(){return!1}var ii=si;z.exports,function(t,e){var r=T,a=ii,n=e&&!e.nodeType&&e,s=n&&!0&&t&&!t.nodeType&&t,i=s&&s.exports===n,o=i?r.Buffer:void 0,c=o?o.isBuffer:void 0,l=c||a;t.exports=l}(z,z.exports);var le=z.exports,oi=9007199254740991,ci=/^(?:0|[1-9]\d*)$/;function li(t,e){var r=typeof t;return e=e??oi,!!e&&(r=="number"||r!="symbol"&&ci.test(t))&&t>-1&&t%1==0&&t<e}var ui=li,fi=9007199254740991;function di(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=fi}var Ve=di,hi=B,gi=Ve,pi=C,yi="[object Arguments]",bi="[object Array]",vi="[object Boolean]",$i="[object Date]",_i="[object Error]",mi="[object Function]",Ai="[object Map]",wi="[object Number]",Ti="[object Object]",Oi="[object RegExp]",Si="[object Set]",Ci="[object String]",ji="[object WeakMap]",Ei="[object ArrayBuffer]",Ii="[object DataView]",Pi="[object Float32Array]",xi="[object Float64Array]",Mi="[object Int8Array]",Ni="[object Int16Array]",Ri="[object Int32Array]",Li="[object Uint8Array]",Di="[object Uint8ClampedArray]",Fi="[object Uint16Array]",Bi="[object Uint32Array]",g={};g[Pi]=g[xi]=g[Mi]=g[Ni]=g[Ri]=g[Li]=g[Di]=g[Fi]=g[Bi]=!0,g[yi]=g[bi]=g[Ei]=g[vi]=g[Ii]=g[$i]=g[_i]=g[mi]=g[Ai]=g[wi]=g[Ti]=g[Oi]=g[Si]=g[Ci]=g[ji]=!1;function Ui(t){return pi(t)&&gi(t.length)&&!!g[hi(t)]}var Gi=Ui;function Ki(t){return function(e){return t(e)}}var ue=Ki,V={exports:{}};V.exports,function(t,e){var r=Se,a=e&&!e.nodeType&&e,n=a&&!0&&t&&!t.nodeType&&t,s=n&&n.exports===a,i=s&&r.process,o=function(){try{var c=n&&n.require&&n.require("util").types;return c||i&&i.binding&&i.binding("util")}catch{}}();t.exports=o}(V,V.exports);var fe=V.exports,Hi=Gi,qi=ue,Je=fe,Qe=Je&&Je.isTypedArray,zi=Qe?qi(Qe):Hi,We=zi,Vi=Qs,Ji=ni,Qi=S,Wi=le,Xi=ui,Yi=We,Zi=Object.prototype,ki=Zi.hasOwnProperty;function eo(t,e){var r=Qi(t),a=!r&&Ji(t),n=!r&&!a&&Wi(t),s=!r&&!a&&!n&&Yi(t),i=r||a||n||s,o=i?Vi(t.length,String):[],c=o.length;for(var l in t)(e||ki.call(t,l))&&!(i&&(l=="length"||n&&(l=="offset"||l=="parent")||s&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||Xi(l,c)))&&o.push(l);return o}var Xe=eo,to=Object.prototype;function ro(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||to;return t===r}var de=ro;function ao(t,e){return function(r){return t(e(r))}}var Ye=ao,no=Ye,so=no(Object.keys,Object),io=so,oo=de,co=io,lo=Object.prototype,uo=lo.hasOwnProperty;function fo(t){if(!oo(t))return co(t);var e=[];for(var r in Object(t))uo.call(t,r)&&r!="constructor"&&e.push(r);return e}var ho=fo,go=Pe,po=Ve;function yo(t){return t!=null&&po(t.length)&&!go(t)}var Ze=yo,bo=Xe,vo=ho,$o=Ze;function _o(t){return $o(t)?bo(t):vo(t)}var J=_o,mo=q,Ao=J;function wo(t,e){return t&&mo(e,Ao(e),t)}var To=wo;function Oo(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var So=Oo,Co=P,jo=de,Eo=So,Io=Object.prototype,Po=Io.hasOwnProperty;function xo(t){if(!Co(t))return Eo(t);var e=jo(t),r=[];for(var a in t)a=="constructor"&&(e||!Po.call(t,a))||r.push(a);return r}var Mo=xo,No=Xe,Ro=Mo,Lo=Ze;function Do(t){return Lo(t)?No(t,!0):Ro(t)}var he=Do,Fo=q,Bo=he;function Uo(t,e){return t&&Fo(e,Bo(e),t)}var Go=Uo,Q={exports:{}};Q.exports,function(t,e){var r=T,a=e&&!e.nodeType&&e,n=a&&!0&&t&&!t.nodeType&&t,s=n&&n.exports===a,i=s?r.Buffer:void 0,o=i?i.allocUnsafe:void 0;function c(l,u){if(u)return l.slice();var d=l.length,h=o?o(d):new l.constructor(d);return l.copy(h),h}t.exports=c}(Q,Q.exports);var Ko=Q.exports;function Ho(t,e){var r=-1,a=t.length;for(e||(e=Array(a));++r<a;)e[r]=t[r];return e}var qo=Ho;function zo(t,e){for(var r=-1,a=t==null?0:t.length,n=0,s=[];++r<a;){var i=t[r];e(i,r,t)&&(s[n++]=i)}return s}var Vo=zo;function Jo(){return[]}var ke=Jo,Qo=Vo,Wo=ke,Xo=Object.prototype,Yo=Xo.propertyIsEnumerable,et=Object.getOwnPropertySymbols,Zo=et?function(t){return t==null?[]:(t=Object(t),Qo(et(t),function(e){return Yo.call(t,e)}))}:Wo,ge=Zo,ko=q,ec=ge;function tc(t,e){return ko(t,ec(t),e)}var rc=tc;function ac(t,e){for(var r=-1,a=e.length,n=t.length;++r<a;)t[n+r]=e[r];return t}var tt=ac,nc=Ye,sc=nc(Object.getPrototypeOf,Object),rt=sc,ic=tt,oc=rt,cc=ge,lc=ke,uc=Object.getOwnPropertySymbols,fc=uc?function(t){for(var e=[];t;)ic(e,cc(t)),t=oc(t);return e}:lc,at=fc,dc=q,hc=at;function gc(t,e){return dc(t,hc(t),e)}var pc=gc,yc=tt,bc=S;function vc(t,e,r){var a=e(t);return bc(t)?a:yc(a,r(t))}var nt=vc,$c=nt,_c=ge,mc=J;function Ac(t){return $c(t,mc,_c)}var st=Ac,wc=nt,Tc=at,Oc=he;function Sc(t){return wc(t,Oc,Tc)}var Cc=Sc,jc=j,Ec=T,Ic=jc(Ec,"DataView"),Pc=Ic,xc=j,Mc=T,Nc=xc(Mc,"Promise"),Rc=Nc,Lc=j,Dc=T,Fc=Lc(Dc,"Set"),Bc=Fc,Uc=j,Gc=T,Kc=Uc(Gc,"WeakMap"),Hc=Kc,pe=Pc,ye=se,be=Rc,ve=Bc,$e=Hc,it=B,L=Me,ot="[object Map]",qc="[object Object]",ct="[object Promise]",lt="[object Set]",ut="[object WeakMap]",ft="[object DataView]",zc=L(pe),Vc=L(ye),Jc=L(be),Qc=L(ve),Wc=L($e),E=it;(pe&&E(new pe(new ArrayBuffer(1)))!=ft||ye&&E(new ye)!=ot||be&&E(be.resolve())!=ct||ve&&E(new ve)!=lt||$e&&E(new $e)!=ut)&&(E=function(t){var e=it(t),r=e==qc?t.constructor:void 0,a=r?L(r):"";if(a)switch(a){case zc:return ft;case Vc:return ot;case Jc:return ct;case Qc:return lt;case Wc:return ut}return e});var W=E,Xc=Object.prototype,Yc=Xc.hasOwnProperty;function Zc(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&Yc.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var kc=Zc,el=T,tl=el.Uint8Array,dt=tl,ht=dt;function rl(t){var e=new t.constructor(t.byteLength);return new ht(e).set(new ht(t)),e}var _e=rl,al=_e;function nl(t,e){var r=e?al(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}var sl=nl,il=/\w*$/;function ol(t){var e=new t.constructor(t.source,il.exec(t));return e.lastIndex=t.lastIndex,e}var cl=ol,gt=D,pt=gt?gt.prototype:void 0,yt=pt?pt.valueOf:void 0;function ll(t){return yt?Object(yt.call(t)):{}}var ul=ll,fl=_e;function dl(t,e){var r=e?fl(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var hl=dl,gl=_e,pl=sl,yl=cl,bl=ul,vl=hl,$l="[object Boolean]",_l="[object Date]",ml="[object Map]",Al="[object Number]",wl="[object RegExp]",Tl="[object Set]",Ol="[object String]",Sl="[object Symbol]",Cl="[object ArrayBuffer]",jl="[object DataView]",El="[object Float32Array]",Il="[object Float64Array]",Pl="[object Int8Array]",xl="[object Int16Array]",Ml="[object Int32Array]",Nl="[object Uint8Array]",Rl="[object Uint8ClampedArray]",Ll="[object Uint16Array]",Dl="[object Uint32Array]";function Fl(t,e,r){var a=t.constructor;switch(e){case Cl:return gl(t);case $l:case _l:return new a(+t);case jl:return pl(t,r);case El:case Il:case Pl:case xl:case Ml:case Nl:case Rl:case Ll:case Dl:return vl(t,r);case ml:return new a;case Al:case Ol:return new a(t);case wl:return yl(t);case Tl:return new a;case Sl:return bl(t)}}var Bl=Fl,Ul=P,bt=Object.create,Gl=function(){function t(){}return function(e){if(!Ul(e))return{};if(bt)return bt(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),Kl=Gl,Hl=Kl,ql=rt,zl=de;function Vl(t){return typeof t.constructor=="function"&&!zl(t)?Hl(ql(t)):{}}var Jl=Vl,Ql=W,Wl=C,Xl="[object Map]";function Yl(t){return Wl(t)&&Ql(t)==Xl}var Zl=Yl,kl=Zl,eu=ue,vt=fe,$t=vt&&vt.isMap,tu=$t?eu($t):kl,ru=tu,au=W,nu=C,su="[object Set]";function iu(t){return nu(t)&&au(t)==su}var ou=iu,cu=ou,lu=ue,_t=fe,mt=_t&&_t.isSet,uu=mt?lu(mt):cu,fu=uu,du=ce,hu=Ns,gu=He,pu=To,yu=Go,bu=Ko,vu=qo,$u=rc,_u=pc,mu=st,Au=Cc,wu=W,Tu=kc,Ou=Bl,Su=Jl,Cu=S,ju=le,Eu=ru,Iu=P,Pu=fu,xu=J,Mu=he,Nu=1,Ru=2,Lu=4,At="[object Arguments]",Du="[object Array]",Fu="[object Boolean]",Bu="[object Date]",Uu="[object Error]",wt="[object Function]",Gu="[object GeneratorFunction]",Ku="[object Map]",Hu="[object Number]",Tt="[object Object]",qu="[object RegExp]",zu="[object Set]",Vu="[object String]",Ju="[object Symbol]",Qu="[object WeakMap]",Wu="[object ArrayBuffer]",Xu="[object DataView]",Yu="[object Float32Array]",Zu="[object Float64Array]",ku="[object Int8Array]",ef="[object Int16Array]",tf="[object Int32Array]",rf="[object Uint8Array]",af="[object Uint8ClampedArray]",nf="[object Uint16Array]",sf="[object Uint32Array]",f={};f[At]=f[Du]=f[Wu]=f[Xu]=f[Fu]=f[Bu]=f[Yu]=f[Zu]=f[ku]=f[ef]=f[tf]=f[Ku]=f[Hu]=f[Tt]=f[qu]=f[zu]=f[Vu]=f[Ju]=f[rf]=f[af]=f[nf]=f[sf]=!0,f[Uu]=f[wt]=f[Qu]=!1;function X(t,e,r,a,n,s){var i,o=e&Nu,c=e&Ru,l=e&Lu;if(r&&(i=n?r(t,a,n,s):r(t)),i!==void 0)return i;if(!Iu(t))return t;var u=Cu(t);if(u){if(i=Tu(t),!o)return vu(t,i)}else{var d=wu(t),h=d==wt||d==Gu;if(ju(t))return bu(t,o);if(d==Tt||d==At||h&&!n){if(i=c||h?{}:Su(t),!o)return c?_u(t,yu(i,t)):$u(t,pu(i,t))}else{if(!f[d])return n?t:{};i=Ou(t,d,o)}}s||(s=new du);var w=s.get(t);if(w)return w;s.set(t,i),Pu(t)?t.forEach(function(v){i.add(X(v,e,r,v,t,s))}):Eu(t)&&t.forEach(function(v,_){i.set(_,X(v,e,r,_,t,s))});var m=l?c?Au:mu:c?Mu:xu,A=u?void 0:m(t);return hu(A||t,function(v,_){A&&(_=v,v=t[_]),gu(i,_,X(v,e,r,_,t,s))}),i}var of=X,cf="__lodash_hash_undefined__";function lf(t){return this.__data__.set(t,cf),this}var uf=lf;function ff(t){return this.__data__.has(t)}var df=ff,hf=ie,gf=uf,pf=df;function Y(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new hf;++e<r;)this.add(t[e])}Y.prototype.add=Y.prototype.push=gf,Y.prototype.has=pf;var yf=Y;function bf(t,e){for(var r=-1,a=t==null?0:t.length;++r<a;)if(e(t[r],r,t))return!0;return!1}var vf=bf;function $f(t,e){return t.has(e)}var _f=$f,mf=yf,Af=vf,wf=_f,Tf=1,Of=2;function Sf(t,e,r,a,n,s){var i=r&Tf,o=t.length,c=e.length;if(o!=c&&!(i&&c>o))return!1;var l=s.get(t),u=s.get(e);if(l&&u)return l==e&&u==t;var d=-1,h=!0,w=r&Of?new mf:void 0;for(s.set(t,e),s.set(e,t);++d<o;){var m=t[d],A=e[d];if(a)var v=i?a(A,m,d,e,t,s):a(m,A,d,t,e,s);if(v!==void 0){if(v)continue;h=!1;break}if(w){if(!Af(e,function(_,I){if(!wf(w,I)&&(m===_||n(m,_,r,a,s)))return w.push(I)})){h=!1;break}}else if(!(m===A||n(m,A,r,a,s))){h=!1;break}}return s.delete(t),s.delete(e),h}var Ot=Sf;function Cf(t){var e=-1,r=Array(t.size);return t.forEach(function(a,n){r[++e]=[n,a]}),r}var jf=Cf;function Ef(t){var e=-1,r=Array(t.size);return t.forEach(function(a){r[++e]=a}),r}var If=Ef,St=D,Ct=dt,Pf=ne,xf=Ot,Mf=jf,Nf=If,Rf=1,Lf=2,Df="[object Boolean]",Ff="[object Date]",Bf="[object Error]",Uf="[object Map]",Gf="[object Number]",Kf="[object RegExp]",Hf="[object Set]",qf="[object String]",zf="[object Symbol]",Vf="[object ArrayBuffer]",Jf="[object DataView]",jt=St?St.prototype:void 0,me=jt?jt.valueOf:void 0;function Qf(t,e,r,a,n,s,i){switch(r){case Jf:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Vf:return!(t.byteLength!=e.byteLength||!s(new Ct(t),new Ct(e)));case Df:case Ff:case Gf:return Pf(+t,+e);case Bf:return t.name==e.name&&t.message==e.message;case Kf:case qf:return t==e+"";case Uf:var o=Mf;case Hf:var c=a&Rf;if(o||(o=Nf),t.size!=e.size&&!c)return!1;var l=i.get(t);if(l)return l==e;a|=Lf,i.set(t,e);var u=xf(o(t),o(e),a,n,s,i);return i.delete(t),u;case zf:if(me)return me.call(t)==me.call(e)}return!1}var Wf=Qf,Et=st,Xf=1,Yf=Object.prototype,Zf=Yf.hasOwnProperty;function kf(t,e,r,a,n,s){var i=r&Xf,o=Et(t),c=o.length,l=Et(e),u=l.length;if(c!=u&&!i)return!1;for(var d=c;d--;){var h=o[d];if(!(i?h in e:Zf.call(e,h)))return!1}var w=s.get(t),m=s.get(e);if(w&&m)return w==e&&m==t;var A=!0;s.set(t,e),s.set(e,t);for(var v=i;++d<c;){h=o[d];var _=t[h],I=e[h];if(a)var qt=i?a(I,_,h,e,t,s):a(_,I,h,t,e,s);if(!(qt===void 0?_===I||n(_,I,r,a,s):qt)){A=!1;break}v||(v=h=="constructor")}if(A&&!v){var ee=t.constructor,te=e.constructor;ee!=te&&"constructor"in t&&"constructor"in e&&!(typeof ee=="function"&&ee instanceof ee&&typeof te=="function"&&te instanceof te)&&(A=!1)}return s.delete(t),s.delete(e),A}var ed=kf,Ae=ce,td=Ot,rd=Wf,ad=ed,It=W,Pt=S,xt=le,nd=We,sd=1,Mt="[object Arguments]",Nt="[object Array]",Z="[object Object]",id=Object.prototype,Rt=id.hasOwnProperty;function od(t,e,r,a,n,s){var i=Pt(t),o=Pt(e),c=i?Nt:It(t),l=o?Nt:It(e);c=c==Mt?Z:c,l=l==Mt?Z:l;var u=c==Z,d=l==Z,h=c==l;if(h&&xt(t)){if(!xt(e))return!1;i=!0,u=!1}if(h&&!u)return s||(s=new Ae),i||nd(t)?td(t,e,r,a,n,s):rd(t,e,c,r,a,n,s);if(!(r&sd)){var w=u&&Rt.call(t,"__wrapped__"),m=d&&Rt.call(e,"__wrapped__");if(w||m){var A=w?t.value():t,v=m?e.value():e;return s||(s=new Ae),n(A,v,r,a,s)}}return h?(s||(s=new Ae),ad(t,e,r,a,n,s)):!1}var cd=od,ld=cd,Lt=C;function Dt(t,e,r,a,n){return t===e?!0:t==null||e==null||!Lt(t)&&!Lt(e)?t!==t&&e!==e:ld(t,e,r,a,Dt,n)}var ud=Dt,fd=ce,dd=ud,hd=1,gd=2;function pd(t,e,r,a){var n=r.length,s=n,i=!a;if(t==null)return!s;for(t=Object(t);n--;){var o=r[n];if(i&&o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++n<s;){o=r[n];var c=o[0],l=t[c],u=o[1];if(i&&o[2]){if(l===void 0&&!(c in t))return!1}else{var d=new fd;if(a)var h=a(l,u,c,t,e,d);if(!(h===void 0?dd(u,l,hd|gd,a,d):h))return!1}}return!0}var yd=pd,bd=P;function vd(t){return t===t&&!bd(t)}var $d=vd,_d=$d,md=J;function Ad(t){for(var e=md(t),r=e.length;r--;){var a=e[r],n=t[a];e[r]=[a,n,_d(n)]}return e}var wd=Ad;function Td(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}var Od=Td,Sd=yd,Cd=wd,jd=Od;function Ed(t){var e=Cd(t);return e.length==1&&e[0][2]?jd(e[0][0],e[0][1]):function(r){return r===t||Sd(r,t,e)}}var Id=Ed,Pd=of,xd=Id,Md=1;function Nd(t){return xd(Pd(t,Md))}var Rd=Nd;const Ld=O(Rd);class we{constructor({items:e=[],identifierName:r="id",getNewId:a}={}){y(this,"sequence",0);y(this,"items",[]);y(this,"database",null);y(this,"name",null);y(this,"identifierName","id");y(this,"getNewId");if(!Array.isArray(e))throw new Error("Can't initialize a Collection with anything else than an array of items");this.identifierName=r,this.getNewId=a||this.getNewIdFromSequence,e.map(this.addOne.bind(this))}setDatabase(e){this.database=e}setName(e){this.name=e}_oneToManyEmbedder(e){if(this.name==null)throw new Error("Can't embed references without a collection name");const a=`${this.name.slice(0,-1)}_id`;return n=>{if(this.database==null)throw new Error("Can't embed references without a database");const s=this.database.collections[e];if(!s)throw new Error(`Can't embed a non-existing collection ${e}`);return Array.isArray(n[e])?n[e]=s.getAll({filter:i=>n[e].indexOf(i[s.identifierName])!==-1}):n[e]=s.getAll({filter:i=>i[a]===n[this.identifierName]}),n}}_manyToOneEmbedder(e){const r=`${e}s`,a=`${e}_id`;return n=>{if(this.database==null)throw new Error("Can't embed references without a database");const s=this.database.collections[r];if(!s)throw new Error(`Can't embed a non-existing collection ${e}`);try{n[e]=s.getOne(n[a])}catch{}return n}}_itemEmbedder(e){const a=(Array.isArray(e)?e:[e]).map(n=>n.endsWith("s")?this._oneToManyEmbedder(n):this._manyToOneEmbedder(n));return n=>a.reduce((s,i)=>i(s),n)}getCount(e){return this.getAll(e).length}getAll(e){let r=this.items.slice(0);return e&&(e.filter&&(r=Bt(r,e.filter)),e.sort&&(r=Ud(r,e.sort)),e.range&&(r=Gd(r,e.range)),r=r.map(a=>Object.assign({},a)),e.embed&&this.database&&(r=r.map(this._itemEmbedder(e.embed)))),r}getIndex(e){return this.items.findIndex(r=>r[this.identifierName]==e)}getOne(e,r){const a=this.getIndex(e);if(a===-1)throw new Error(`No item with identifier ${e}`);let n=this.items[a];return n=Object.assign({},n),r!=null&&r.embed&&this.database&&(n=this._itemEmbedder(r.embed)(n)),n}getNewIdFromSequence(){return this.sequence++}addOne(e){const r=e[this.identifierName];if(r!=null){if(this.getIndex(r)!==-1)throw new Error(`An item with the identifier ${r} already exists`);typeof r=="number"&&(this.sequence=Math.max(this.sequence,r)+1)}else e[this.identifierName]=this.getNewId();return this.items.push(e),Object.assign({},e)}updateOne(e,r){const a=this.getIndex(e);if(a===-1)throw new Error(`No item with identifier ${e}`);for(const n in r)this.items[a][n]=r[n];return Object.assign({},this.items[a])}removeOne(e){const r=this.getIndex(e);if(r===-1)throw new Error(`No item with identifier ${e}`);const a=this.items[r];return this.items.splice(r,1),typeof e=="number"&&e==this.sequence-1&&this.sequence--,a}}const Dd=(t,e)=>t.reduce((r,a)=>r&&e(a),!0),Fd=(t,e)=>t.reduce((r,a)=>r||e(a),!1),Bd=(t,e)=>t.reduce((r,a,n)=>{if(r!=null)return r;const s=t.slice(0,n+1).join("."),i=t.slice(n+1).join("."),o=b(e,s);return Array.isArray(o)&&n<t.length-1?[s,i]:void 0},void 0),Ft=(t,e)=>{if(t.indexOf("_q")!==-1){const r=t.replace(/(_q)$/,""),a=new RegExp(e.toString(),"i");return n=>{var s;return((s=b(n,r))==null?void 0:s.toString().match(a))!==null}}if(t.indexOf("_lte")!==-1){const r=t.replace(/(_lte)$/,"");return a=>b(a,r)<=e}if(t.indexOf("_gte")!==-1){const r=t.replace(/(_gte)$/,"");return a=>b(a,r)>=e}if(t.indexOf("_lt")!==-1){const r=t.replace(/(_lt)$/,"");return a=>b(a,r)<e}if(t.indexOf("_gt")!==-1){const r=t.replace(/(_gt)$/,"");return a=>b(a,r)>e}if(t.indexOf("_neq_any")!==-1){const r=t.replace(/(_neq_any)$/,""),a=Array.isArray(e)?e:[e];return n=>a.every(s=>b(n,r)!=s)}if(t.indexOf("_neq")!==-1){const r=t.replace(/(_neq)$/,"");return a=>b(a,r)!=e}if(t.indexOf("_eq_any")!==-1){const r=t.replace(/(_eq_any)$/,""),a=Array.isArray(e)?e:[e];return n=>a.some(s=>b(n,r)==s)}if(t.indexOf("_eq")!==-1){const r=t.replace(/(_eq)$/,"");return a=>b(a,r)==e}if(t.indexOf("_inc_any")!==-1){const r=t.replace(/(_inc_any)$/,""),a=Array.isArray(e)?e:[e];return n=>a.some(s=>{const i=b(n,r);return Array.isArray(i)||typeof i=="string"?i.includes(s):!1})}if(t.indexOf("_inc")!==-1){const r=t.replace(/(_inc)$/,""),a=Array.isArray(e)?e:[e];return n=>a.every(s=>{const i=b(n,r);return Array.isArray(i)||typeof i=="string"?i.includes(s):!1})}if(t.indexOf("_ninc_any")!==-1){const r=t.replace(/(_ninc_any)$/,""),a=Array.isArray(e)?e:[e];return n=>a.every(s=>{const i=b(n,r);return Array.isArray(i)||typeof i=="string"?!i.includes(s):!1})}return Array.isArray(e)?r=>Array.isArray(b(r,t))?Dd(e,a=>{const n=b(r,t);return Array.isArray(n)?Fd(n,s=>s==a):!1}):e.filter(a=>a==b(r,t)).length>0:typeof e=="object"?r=>Ld(e)(b(r,t)):r=>{const a=b(r,t);return Array.isArray(a)&&typeof e=="string"?a.indexOf(e)!==-1:typeof a=="boolean"&&typeof e=="string"?a===(e==="true"):a==e}};function Bt(t,e){if(typeof e=="function")return t.filter(e);if(e instanceof Object){const r=Object.keys(e).map(a=>{if(a==="q"&&typeof e.q=="string"){const i=Kd(e.q),o=c=>{for(const l in c){const u=c[l];if(typeof u=="object"&&o(u)||u&&typeof u=="string"&&u.match&&u.match(i)!==null)return!0}return!1};return o}const n=a.split("."),s=e[a];return n.length>1?i=>{const o=Bd(n,i);if(o){const[c,l]=o,u=b(i,c);return Array.isArray(u)?Bt(u,{[l]:s}).length>0:!1}return Ft(a,s)(i)}:Ft(a,s)});return t.filter(a=>r.reduce((n,s)=>n&&s(a),!0))}throw new Error("Unsupported filter type")}function Ud(t,e){if(typeof e=="function")return t.sort(e);if(typeof e=="string")return t.sort((r,a)=>r[e]>a[e]?1:r[e]<a[e]?-1:0);if(Array.isArray(e)){const r=e[0],a=e[1].toLowerCase()==="asc"?1:-1;return t.sort((n,s)=>n[r]>s[r]?a:n[r]<s[r]?-1*a:0)}throw new Error("Unsupported sort type")}function Gd(t,e){if(Array.isArray(e))return t.slice(e[0],e[1]!==void 0?e[1]+1:void 0);throw new Error("Unsupported range type")}function Kd(t){const n=t.trim().replace(/[.*+?^${}()|[\]\\]/g,"\\$&").split(" ").map(i=>`(${i})`).join("|");return new RegExp(n,"i")}class Ut{constructor(e){y(this,"obj",null);y(this,"database",null);y(this,"name",null);if(!(e instanceof Object))throw new Error("Can't initialize a Single with anything except an object");this.obj=e}setDatabase(e){this.database=e}setName(e){this.name=e}_oneToManyEmbedder(e){return r=>{if(this.database==null)throw new Error("Can't embed references without a database");const a=this.database.collections[e];if(!a)throw new Error(`Can't embed a non-existing collection ${e}`);return r[e]=a.getAll({filter:n=>r[e].indexOf(n[a.identifierName])!==-1}),r}}_manyToOneEmbedder(e){const r=`${e}s`,a=`${e}_id`;return n=>{if(this.database==null)throw new Error("Can't embed references without a database");const s=this.database.collections[r];if(!s)throw new Error(`Can't embed a non-existing collection ${e}`);try{n[e]=s.getOne(n[a])}catch{}return n}}_itemEmbedder(e){const a=(Array.isArray(e)?e:[e]).map(n=>n.endsWith("s")?this._oneToManyEmbedder(n):this._manyToOneEmbedder(n));return n=>a.reduce((s,i)=>i(s),n)}getOnly(e){let r=this.obj;return e!=null&&e.embed&&this.database&&(r=Object.assign({},r),r=this._itemEmbedder(e.embed)(r)),r}updateOnly(e){if(this.obj==null)throw new Error("Can't update a non-existing object");for(const r in e)this.obj[r]=e[r];return this.obj}}class Gt{constructor({data:e,identifierName:r="id",getNewId:a}={}){y(this,"identifierName","id");y(this,"collections",{});y(this,"singles",{});y(this,"getNewId");this.getNewId=a,this.identifierName=r,e&&this.init(e)}init(e){for(const r in e){const a=e[r];Array.isArray(a)?this.addCollection(r,new we({items:a,identifierName:this.identifierName,getNewId:this.getNewId})):this.addSingle(r,new Ut(a))}}addCollection(e,r){this.collections[e]=r,r.setDatabase(this),r.setName(e)}getCollection(e){return this.collections[e]}getCollectionNames(){return Object.keys(this.collections)}addSingle(e,r){this.singles[e]=r,r.setDatabase(this),r.setName(e)}getSingle(e){return this.singles[e]}getSingleNames(){return Object.keys(this.singles)}getCount(e,r){return this.collections[e].getCount(r)}getAll(e,r){return this.collections[e].getAll(r)}getOne(e,r,a){return this.collections[e].getOne(r,a)}addOne(e,r){return Object.prototype.hasOwnProperty.call(this.collections,e)||this.addCollection(e,new we({items:[],identifierName:this.identifierName,getNewId:this.getNewId})),this.collections[e].addOne(r)}updateOne(e,r,a){return this.collections[e].updateOne(r,a)}removeOne(e,r){return this.collections[e].removeOne(r)}getOnly(e,r){return this.singles[e].getOnly()}updateOnly(e,r){return this.singles[e].updateOnly(r)}}class k{constructor({baseUrl:e="",defaultQuery:r=()=>({}),database:a,middlewares:n,...s}={}){y(this,"baseUrl","");y(this,"defaultQuery",()=>({}));y(this,"middlewares");y(this,"database");this.baseUrl=e,this.defaultQuery=r,this.middlewares=n||[],a?this.database=a:this.database=new Gt(s)}setDefaultQuery(e){this.defaultQuery=e}getContext(e){var a,n;for(const s of this.database.getSingleNames())if((a=e.url)!=null&&a.match(new RegExp(`^${this.baseUrl}\\/(${s})(\\/?.*)?$`)))return{...e,single:s};const r=(n=e.url)==null?void 0:n.match(new RegExp(`^${this.baseUrl}\\/([^\\/?]+)(\\/(\\w+|\\d+))?(\\?.*)?$`));if(r){const s=r[1],i=Object.assign({},this.defaultQuery(s),e.params);return{...e,collection:s,params:i}}return e}async handle(e){const r=this.getContext(e);let a=0;const n=[...this.middlewares],s=i=>{const o=n[a++];return o?o(i,s):this.handleRequest(i)};try{return await s(r)}catch(i){if(i instanceof Error)throw i;return i}}handleRequest(e){var s,i;for(const o of this.database.getSingleNames())if((s=e.url)!=null&&s.match(new RegExp(`^${this.baseUrl}\\/(${o})(\\/?.*)?$`))){if(e.method==="GET")try{return{status:200,body:this.database.getOnly(o),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}if(e.method==="PUT")try{return e.requestBody==null?{status:400,headers:{}}:{status:200,body:this.database.updateOnly(o,e.requestBody),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}if(e.method==="PATCH")try{return e.requestBody==null?{status:400,headers:{}}:{status:200,body:this.database.updateOnly(o,e.requestBody),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}}const r=(i=e.url)==null?void 0:i.match(new RegExp(`^${this.baseUrl}\\/([^\\/?]+)(\\/(\\w+|\\d+))?(\\?.*)?$`));if(!r)return{status:404,headers:{}};const a=r[1],n=Object.assign({},this.defaultQuery(a),e.params);if(r[2]){if(!this.database.getCollection(a))return{status:404,headers:{}};const o=r[3];if(e.method==="GET")try{return{status:200,body:this.database.getOne(a,o,n),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}if(e.method==="PUT")try{return e.requestBody==null?{status:400,headers:{}}:{status:200,body:this.database.updateOne(a,o,e.requestBody),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}if(e.method==="PATCH")try{return e.requestBody==null?{status:400,headers:{}}:{status:200,body:this.database.updateOne(a,o,e.requestBody),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}if(e.method==="DELETE")try{return{status:200,body:this.database.removeOne(a,o),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}}else{if(e.method==="GET"){if(!this.database.getCollection(a))return{status:404,headers:{}};const o=this.database.getCount(a,n.filter?{filter:n.filter}:{});if(o>0){const c=this.database.getAll(a,n),l=n.range?n.range[0]:0,u=n.range&&n.range.length===2?Math.min(c.length-1+l,n.range[1]):c.length-1;return{status:c.length===o?200:206,body:c,headers:{"Content-Type":"application/json","Content-Range":`items ${l}-${u}/${o}`}}}return{status:200,body:[],headers:{"Content-Type":"application/json","Content-Range":"items */0"}}}if(e.method==="POST"){if(e.requestBody==null)return{status:400,headers:{}};const o=this.database.addOne(a,e.requestBody),c=`${this.baseUrl}/${a}/${o[this.database.getCollection(a).identifierName]}`;return{status:201,body:o,headers:{"Content-Type":"application/json",Location:c}}}}return{status:404,headers:{}}}addMiddleware(e){this.middlewares.push(e)}addCollection(e,r){this.database.addCollection(e,r)}getCollection(e){return this.database.getCollection(e)}getCollectionNames(){return this.database.getCollectionNames()}addSingle(e,r){this.database.addSingle(e,r)}getSingle(e){return this.database.getSingle(e)}getSingleNames(){return this.database.getSingleNames()}}function Kt(t){if(!t)return{};const e={};return t.split("&").map(a=>{if(a.indexOf("=")===-1)e[a]=!0;else{let[n,s]=a.split("=");(s.indexOf("[")===0||s.indexOf("{")===0)&&(s=JSON.parse(s)),e[n.trim()]=s}}),e}class Te{constructor({loggingEnabled:e=!1,server:r,...a}={}){y(this,"loggingEnabled",!1);y(this,"server");this.server=r||new k(a),this.loggingEnabled=e}getHandler(){return async e=>{e.readyState=4;const r=this.getNormalizedRequest(e),a=await this.server.handle(r);this.respond(a,e)}}getNormalizedRequest(e){const r=typeof e=="string"?new Request(e):e,a=r.url?decodeURIComponent(r.url.slice(r.url.indexOf("?")+1)):"",n=Kt(a);let s;if(r.requestBody)try{s=JSON.parse(r.requestBody)}catch{}return{url:r.url,headers:new Headers(e.requestHeaders),params:n,requestBody:s,method:r.method}}respond(e,r){const a={status:e.status,body:e.body??"",headers:e.headers??{}};Array.isArray(a.headers)?a.headers.find(n=>n.name.toLowerCase()==="content-type")||a.headers.push({name:"Content-Type",value:"application/json"}):a.headers["Content-Type"]||(a.headers["Content-Type"]="application/json"),r.readyState=1,r.respond(a.status,a.headers,JSON.stringify(a.body)),this.log(r,a)}log(e,r){this.loggingEnabled&&(console.group?(console.groupCollapsed(e.method,e.url,"(FakeRest)"),console.group("request"),console.log(e.method,e.url),console.log("headers",e.requestHeaders),console.log("body   ",e.requestBody),console.groupEnd(),console.group("response",r.status),console.log("headers",r.headers),console.log("body   ",r.body),console.groupEnd(),console.groupEnd()):(console.log("FakeRest request ",e.method,e.url,"headers",e.requestHeaders,"body",e.requestBody),console.log("FakeRest response",r.status,"headers",r.headers,"body",r.body)))}toggleLogging(){this.loggingEnabled=!this.loggingEnabled}}const Hd=t=>new Te(t).getHandler(),qd=Te;class Oe{constructor({loggingEnabled:e=!1,server:r,...a}={}){y(this,"loggingEnabled",!1);y(this,"server");this.server=r||new k(a),this.loggingEnabled=e}getHandler(){return async(r,a)=>{const n=new Request(r,a),s=await this.getNormalizedRequest(n),i=await this.server.handle(s);return this.log(n,i,s),i}}async getNormalizedRequest(e){const r=typeof e=="string"?new Request(e):e,a=r.url?decodeURIComponent(r.url.slice(r.url.indexOf("?")+1)):"",n=Kt(a),s=await r.text();let i;try{i=JSON.parse(s)}catch{}return{url:r.url,headers:r.headers,params:n,requestBody:i,method:r.method}}log(e,r,a){this.loggingEnabled&&(console.group?(console.groupCollapsed(a.method,a.url,"(FakeRest)"),console.group("request"),console.log(a.method,a.url),console.log("headers",e.headers),console.log("body   ",e.requestJson),console.groupEnd(),console.group("response",r.status),console.log("headers",r.headers),console.log("body   ",r.body),console.groupEnd(),console.groupEnd()):(console.log("FakeRest request ",a.method,a.url,"headers",e.headers,"body",e.requestJson),console.log("FakeRest response",r.status,"headers",r.headers,"body",r.body)))}toggleLogging(){this.loggingEnabled=!this.loggingEnabled}}const zd=t=>new Oe(t).getHandler(),Vd=Oe;class Ht{constructor({server:e,...r}){y(this,"server");this.server=e||new k(r)}getHandler(){return async({request:e})=>{const r=await this.getNormalizedRequest(e),a=await this.server.handle(r);return new Response(JSON.stringify(a.body),{status:a.status,headers:a.headers})}}async getNormalizedRequest(e){const r=new URL(e.url),a=Object.fromEntries(Array.from(new URLSearchParams(r.search).entries()).map(([s,i])=>[s,JSON.parse(i)]));let n;try{const s=await e.text();n=JSON.parse(s)}catch{}return{url:e.url,headers:e.headers,params:a,requestBody:n,method:e.method}}}const Jd=t=>new Ht(t).getHandler(),Qd=t=>(e,r)=>new Promise(a=>{setTimeout(()=>{a(r(e))},t)});p.Collection=we,p.Database=Gt,p.FetchMockAdapter=Oe,p.FetchServer=Vd,p.MswAdapter=Ht,p.Server=qd,p.SimpleRestServer=k,p.Single=Ut,p.SinonAdapter=Te,p.getFetchMockHandler=zd,p.getMswHandler=Jd,p.getSinonHandler=Hd,p.withDelay=Qd,Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=fakerest.min.umd.cjs.map
